<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperHDG: Example C++ code for diffusion</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HyperHDG
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example C++ code for diffusion </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr  />
<p>Alternatively, one can use <a class="el" href="namespaceHyperHDG.html" title="Python interface for HyperHDG library.">HyperHDG</a> as C++ library. Please note that for this purpose, the include directory of <a class="el" href="namespaceHyperHDG.html" title="Python interface for HyperHDG library.">HyperHDG</a> as well as the include directories of the submodules need to be added to the compiler's include paths. The flag -DNDEBUG compiles in release mode, while the code is created in debug mode if the flag is missing. Moreover, <a class="el" href="namespaceHyperHDG.html" title="Python interface for HyperHDG library.">HyperHDG</a> needs to be linked to LAPACK, compiled with a standard of C++17, and the compiler needs to be able to find the parameters file in this example.</p>
<p>Please check that your compiler meets the standards of <a class="el" href="namespaceHyperHDG.html" title="Python interface for HyperHDG library.">HyperHDG</a>. Compilers that are tested against in pushes to the master branch and therefore should be safe can be found in the Makefile.</p>
<p>The code of the C++ program that does exactly the same as the aforementioned Python script can be found in the file <a class="el" href="diffusion__elliptic_8cxx.html">examples/diffusion_elliptic.cxx</a>.</p>
<p>Since for C++, we do not have cython_import that finds all the necessary files, we need to include them by hand. Since, we want to conduct the same example again, we have to include the geometry and the topology of a unit cube, as well as the elliptic global loop and the diffusion solver. Additionally, we need a sparse linear algebra providing the CG solver. Last, but not least the parameters need to be included.</p>
 <div class="fragment"><div class="line"><a name="l00000"></a><span class="lineno">    0</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="unit__cube_8hxx.html">HyperHDG/geometry/unit_cube.hxx</a>&gt;</span></div>
<div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="elliptic_8hxx.html">HyperHDG/global_loop/elliptic.hxx</a>&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="diffusion__ldgh_8hxx.html">HyperHDG/local_solver/diffusion_ldgh.hxx</a>&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="node__descriptor_2cubic_8hxx.html">HyperHDG/node_descriptor/cubic.hxx</a>&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="sparse__la_8hxx.html">HyperHDG/sparse_la.hxx</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="examples_2parameters_2diffusion_8hxx.html">examples/parameters/diffusion.hxx</a>&gt;</span></div>
</div><!-- fragment --><p>This has prepared us to define the <code>main</code> function which will surround the rest of the code</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keywordtype">int</span> <a class="code" href="diffusion__elliptic_8cxx.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
</div><!-- fragment --><p>and starts with defining the very same parameters as before.</p>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> poly_degree = 1;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hyEdge_dim = 1;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> space_dim = 2;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> refinement = 1;</div>
</div><!-- fragment --><p>Next, we define the problem class, where the different components have exactly the same meaning as in the hyperhdg_constructor of the Python script. The only difference consists in the fact that this class can immediately be instantiated, which has not been the case in Python, where cython_import had to build it first.</p>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <a class="code" href="classGlobalLoop_1_1Elliptic.html">GlobalLoop::Elliptic&lt;Topology::Cubic&lt;hyEdge_dim, space_dim&gt;</a>,</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                       <a class="code" href="classGeometry_1_1UnitCube.html">Geometry::UnitCube&lt;hyEdge_dim, space_dim&gt;</a>,</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                       <a class="code" href="classNodeDescriptor_1_1Cubic.html">NodeDescriptor::Cubic&lt;hyEdge_dim, space_dim&gt;</a>,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                       <a class="code" href="classLocalSolver_1_1Diffusion.html">LocalSolver::Diffusion</a>&lt;hyEdge_dim, poly_degree, 2 * poly_degree,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                                              <a class="code" href="structHG_1_1DiffusionElliptic.html">HG&lt;hyEdge_dim&gt;::DiffusionElliptic</a>, <span class="keywordtype">double</span>&gt; &gt;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>(std::vector&lt;unsigned int&gt;(space_dim, 1 &lt;&lt; refinement));</div>
</div><!-- fragment --><p>The remainder of the program also works analogously to the Python script, i.e., we first define the right-hand side as negative, homogeneous residuum,</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  std::vector&lt;double&gt; <a class="code" href="namespacediffusion__uniform.html#af94d95d06459e72adfbf1318be11d5e9">vectorRHS</a> = <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>.residual_flux(<a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>.zero_vector());</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespacediffusion__uniform.html#af94d95d06459e72adfbf1318be11d5e9">vectorRHS</a>.size(); ++i)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="namespacediffusion__uniform.html#af94d95d06459e72adfbf1318be11d5e9">vectorRHS</a>[i] *= -1.;</div>
</div><!-- fragment --><p>solve the global system of equations using the CG method,</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  std::vector&lt;double&gt; vectorSolution = <a class="code" href="namespaceSparseLA.html#a26d566fc52e9d2b724dae03bf7c3f971">SparseLA::conjugate_gradient</a>(<a class="code" href="namespacediffusion__uniform.html#af94d95d06459e72adfbf1318be11d5e9">vectorRHS</a>, <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>);</div>
</div><!-- fragment --><p>and print the L^2 error.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>.errors(vectorSolution)[0] &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>At the end, we plot the solution</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>.plot_option(<span class="stringliteral">&quot;fileName&quot;</span>, <span class="stringliteral">&quot;diffusion_elliptic_c++&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>.plot_option(<span class="stringliteral">&quot;printFileNumber&quot;</span>, <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>.plot_option(<span class="stringliteral">&quot;scale&quot;</span>, <span class="stringliteral">&quot;0.95&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">HDG_wrapper</a>.plot_solution(vectorSolution);</div>
</div><!-- fragment --><p>and end the program returning 0.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="anamespaceSparseLA_html_a26d566fc52e9d2b724dae03bf7c3f971"><div class="ttname"><a href="namespaceSparseLA.html#a26d566fc52e9d2b724dae03bf7c3f971">SparseLA::conjugate_gradient</a></div><div class="ttdeci">vectorT conjugate_gradient(const vectorT &amp;b, ProblemT &amp;problem, unsigned int n_iterations=0, const typename vectorT::value_type tolerance=1e-9)</div><div class="ttdoc">Execute conjugate gradient algorithm to find solution to system of equations.</div><div class="ttdef"><b>Definition:</b> sparse_la.hxx:157</div></div>
<div class="ttc" id="anamespacediffusion__uniform_html_af94d95d06459e72adfbf1318be11d5e9"><div class="ttname"><a href="namespacediffusion__uniform.html#af94d95d06459e72adfbf1318be11d5e9">diffusion_uniform.vectorRHS</a></div><div class="ttdeci">list vectorRHS</div><div class="ttdef"><b>Definition:</b> diffusion_uniform.py:36</div></div>
<div class="ttc" id="asparse__la_8hxx_html"><div class="ttname"><a href="sparse__la_8hxx.html">sparse_la.hxx</a></div></div>
<div class="ttc" id="anode__descriptor_2cubic_8hxx_html"><div class="ttname"><a href="node__descriptor_2cubic_8hxx.html">cubic.hxx</a></div></div>
<div class="ttc" id="aclassNodeDescriptor_1_1Cubic_html"><div class="ttname"><a href="classNodeDescriptor_1_1Cubic.html">NodeDescriptor::Cubic</a></div><div class="ttdoc">Definition of the node types of a cubic hypergraph.</div><div class="ttdef"><b>Definition:</b> cubic.hxx:29</div></div>
<div class="ttc" id="aclassGeometry_1_1UnitCube_html"><div class="ttname"><a href="classGeometry_1_1UnitCube.html">Geometry::UnitCube</a></div><div class="ttdoc">Define the geometry of a unit cube that is subdivided into several orthotopes.</div><div class="ttdef"><b>Definition:</b> unit_cube.hxx:37</div></div>
<div class="ttc" id="adiffusion__elliptic_8cxx_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="diffusion__elliptic_8cxx.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> diffusion_elliptic.cxx:8</div></div>
<div class="ttc" id="aunit__cube_8hxx_html"><div class="ttname"><a href="unit__cube_8hxx.html">unit_cube.hxx</a></div></div>
<div class="ttc" id="adiffusion__ldgh_8hxx_html"><div class="ttname"><a href="diffusion__ldgh_8hxx.html">diffusion_ldgh.hxx</a></div></div>
<div class="ttc" id="anamespacediffusion__uniform_html_a0f43b81b81a1487d27f70997e1b6e731"><div class="ttname"><a href="namespacediffusion__uniform.html#a0f43b81b81a1487d27f70997e1b6e731">diffusion_uniform.HDG_wrapper</a></div><div class="ttdeci">HDG_wrapper</div><div class="ttdef"><b>Definition:</b> diffusion_uniform.py:28</div></div>
<div class="ttc" id="aclassLocalSolver_1_1Diffusion_html"><div class="ttname"><a href="classLocalSolver_1_1Diffusion.html">LocalSolver::Diffusion</a></div><div class="ttdoc">Local solver diffusion equation on hypergraph.</div><div class="ttdef"><b>Definition:</b> diffusion_ldgh.hxx:108</div></div>
<div class="ttc" id="astructHG_1_1DiffusionElliptic_html"><div class="ttname"><a href="structHG_1_1DiffusionElliptic.html">HG::DiffusionElliptic</a></div><div class="ttdef"><b>Definition:</b> diffusion.hxx:16</div></div>
<div class="ttc" id="aexamples_2parameters_2diffusion_8hxx_html"><div class="ttname"><a href="examples_2parameters_2diffusion_8hxx.html">diffusion.hxx</a></div></div>
<div class="ttc" id="aelliptic_8hxx_html"><div class="ttname"><a href="elliptic_8hxx.html">elliptic.hxx</a></div></div>
<div class="ttc" id="aclassGlobalLoop_1_1Elliptic_html"><div class="ttname"><a href="classGlobalLoop_1_1Elliptic.html">GlobalLoop::Elliptic</a></div><div class="ttdoc">Combine local solver and global information for elliptic problems.</div><div class="ttdef"><b>Definition:</b> elliptic.hxx:35</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
